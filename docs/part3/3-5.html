<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Reinforcement learning - CS 7646: Machine Learning for Trading</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../welcome.html">Welcome</a></li><li class="chapter-item expanded "><a href="../part1/part1.html"><strong aria-hidden="true">1.</strong> Part 1</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../part1/1-1.html"><strong aria-hidden="true">1.1.</strong> Reading and plotting stock data</a></li><li class="chapter-item expanded "><a href="../part1/1-2.html"><strong aria-hidden="true">1.2.</strong> Working with multiple stocks</a></li><li class="chapter-item expanded "><a href="../part1/1-3.html"><strong aria-hidden="true">1.3.</strong> The power of NumPy</a></li><li class="chapter-item expanded "><a href="../part1/1-4.html"><strong aria-hidden="true">1.4.</strong> Statistical analysis of time series</a></li><li class="chapter-item expanded "><a href="../part1/1-5.html"><strong aria-hidden="true">1.5.</strong> Incomplete data</a></li><li class="chapter-item expanded "><a href="../part1/1-6.html"><strong aria-hidden="true">1.6.</strong> Histograms and scatter plots</a></li><li class="chapter-item expanded "><a href="../part1/1-7.html"><strong aria-hidden="true">1.7.</strong> Sharpe ratio and other portfolio statistics</a></li><li class="chapter-item expanded "><a href="../part1/1-8.html"><strong aria-hidden="true">1.8.</strong> Optimizers</a></li><li class="chapter-item expanded "><a href="../part1/1-9.html"><strong aria-hidden="true">1.9.</strong> How to optimize a portfolio</a></li></ol></li><li class="chapter-item expanded "><a href="../part2/part2.html"><strong aria-hidden="true">2.</strong> Part 2</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../part2/2-1.html"><strong aria-hidden="true">2.1.</strong> So you want to be a hedge fund manager?</a></li><li class="chapter-item expanded "><a href="../part2/2-2.html"><strong aria-hidden="true">2.2.</strong> Market mechanics</a></li><li class="chapter-item expanded "><a href="../part2/2-3.html"><strong aria-hidden="true">2.3.</strong> What is a company worth?</a></li><li class="chapter-item expanded "><a href="../part2/2-4.html"><strong aria-hidden="true">2.4.</strong> The capital assets pricing model (CAPM)</a></li><li class="chapter-item expanded "><a href="../part2/2-5.html"><strong aria-hidden="true">2.5.</strong> How hedge funds use the CAPM</a></li><li class="chapter-item expanded "><a href="../part2/2-6.html"><strong aria-hidden="true">2.6.</strong> Technical analysis</a></li><li class="chapter-item expanded "><a href="../part2/2-7.html"><strong aria-hidden="true">2.7.</strong> Dealing with data</a></li><li class="chapter-item expanded "><a href="../part2/2-8.html"><strong aria-hidden="true">2.8.</strong> Efficient markets hypothesis</a></li><li class="chapter-item expanded "><a href="../part2/2-9.html"><strong aria-hidden="true">2.9.</strong> The fundamental law of active portfolio management</a></li><li class="chapter-item expanded "><a href="../part2/2-10.html"><strong aria-hidden="true">2.10.</strong> Portfolio optimization and the efficient frontier</a></li></ol></li><li class="chapter-item expanded "><a href="../part3/part3.html"><strong aria-hidden="true">3.</strong> Part 3</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../part3/3-1.html"><strong aria-hidden="true">3.1.</strong> How machine learning is used at a hedge fund</a></li><li class="chapter-item expanded "><a href="../part3/3-2.html"><strong aria-hidden="true">3.2.</strong> Regression</a></li><li class="chapter-item expanded "><a href="../part3/3-3.html"><strong aria-hidden="true">3.3.</strong> Assessing a learning algorithm</a></li><li class="chapter-item expanded "><a href="../part3/3-4.html"><strong aria-hidden="true">3.4.</strong> Ensemble learners - bagging and boosting</a></li><li class="chapter-item expanded "><a href="../part3/3-5.html" class="active"><strong aria-hidden="true">3.5.</strong> Reinforcement learning</a></li><li class="chapter-item expanded "><a href="../part3/3-6.html"><strong aria-hidden="true">3.6.</strong> Q-learning</a></li><li class="chapter-item expanded "><a href="../part3/3-7.html"><strong aria-hidden="true">3.7.</strong> Dyna</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CS 7646: Machine Learning for Trading</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="3-5-reinforcement-learning"><a class="header" href="#3-5-reinforcement-learning">3-5: Reinforcement learning</a></h1>
<p>Reinforcement learners provide policies on which actions to take. Recently we've
only been focused on regression tree learners.</p>
<h2 id="the-rl-problem"><a class="header" href="#the-rl-problem">The RL problem</a></h2>
<p>The professor breaks down <strong>reinforcement learning</strong> in the terms of robotics,
since he's originally a roboticist. These concepts can also be applied to stock
trading, but the pieces of the puzzle are as follows:</p>
<ul>
<li><strong>reinforcement learning</strong> follows a <strong>sense</strong>, <strong>think</strong>, <strong>act</strong> cycle.</li>
<li>We have some <strong>policy</strong> called <strong>pi</strong> that receives the state of the
environment, <strong>S</strong>.
<ul>
<li><strong>pi</strong> generates some <strong>action</strong>, <strong>A</strong>.</li>
<li>This <strong>action</strong> has some affect on the environment.</li>
</ul>
</li>
<li>Changes are made to the environment based upon our actions, and then we sense
again to acquire the environment's state <strong>S</strong>.</li>
<li>Ultimately, we receive some reward <strong>R</strong> from our actions on the environment,
and we want our reinforcement learning to maximize that reward.</li>
<li>Finally, our algorithm <strong>Q</strong> interprets what actions generate a state that
ends up in a <strong>reward</strong>, and uses this to update the <strong>pi</strong> policy.</li>
</ul>
<p>All of these concepts can also be applied to a Q-learning robot that generates
orders in the stock market. Please find below a high-level overview from the
course:</p>
<p><img src="./assets/reinforcement-learning.png" alt="reinforcement-learning" /></p>
<h2 id="trading-as-an-rl-problem"><a class="header" href="#trading-as-an-rl-problem">Trading as an RL problem</a></h2>
<p>The professor provides us with a quiz to break down different actions, states,
and rewards in regards to trading:</p>
<p><img src="./assets/trading-as-an-rl-problem.png" alt="trading-as-an-rl-problem" /></p>
<h2 id="markov-decision-problems"><a class="header" href="#markov-decision-problems">Markov decision problems</a></h2>
<p>Pretty much covers the previous sections, however, we discuss
<strong>transition functions</strong> where we identify states <strong>S</strong>, some action <strong>A</strong>, and
then we find probabilities to end up in state <strong>S prime</strong>. Our transition
function must sum all probabilities for this three-dimensional data structure to
1.0. We also have a <strong>reward function</strong> that identifies that some state <strong>S</strong>
also provides us with a <strong>reward</strong> by executing action <strong>A</strong>.</p>
<p>So the purpose of solving this problem is to find policies <strong>pi</strong> that interpret
<strong>S</strong> to maximize reward. How we do this is via:</p>
<ul>
<li><strong>policy iteration</strong></li>
<li><strong>value iteration</strong></li>
</ul>
<p><img src="./assets/markov-decision-problems.png" alt="markov-decision-problems" /></p>
<h2 id="unknown-transitions-and-rewards"><a class="header" href="#unknown-transitions-and-rewards">Unknown transitions and rewards</a></h2>
<p><strong>Experience tuples</strong> are sets of data that relate a <strong>state</strong>, an <strong>action</strong>,
a <strong>state prime</strong> after the action occurs, and a <strong>reward</strong>. As we continue to
encounter new situations, this data structure increases in size with the number
of experiences.</p>
<p>We can leverage this data in two ways to conduct reinforcement learning:</p>
<ul>
<li><strong>model-based</strong>
<ul>
<li>build a model using <strong>transition functions</strong> and <strong>reward functions</strong></li>
<li>conduct value or policy iteration</li>
</ul>
</li>
<li><strong>model-free</strong>
<ul>
<li>this involves <strong>q-learning</strong> where we inspect the data as a whole</li>
</ul>
</li>
</ul>
<h2 id="what-to-optimize"><a class="header" href="#what-to-optimize">What to optimize?</a></h2>
<p>The professor discusses the different types of reward given the
<strong>amount of time</strong> we have to acquire that reward - <strong>our horizon</strong>. In the
slide below, the robot searches for a reward - obviously the $1 reward is more
immediate while the $1M reward is harder to reach.</p>
<p>What we use in Q-learning is the <strong>discounted reward</strong>, modified by <strong>gamma</strong> as
the horizon approaches infinity. <strong>Gamma</strong> can effectively be our interest rate
and, as we see here, it effectively devalues our reward as time goes on. This is
all to say that money today is worth more than money tomorrow.</p>
<p><img src="./assets/what-to-optimize.png" alt="what-to-optimize" /></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../part3/3-4.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="../part3/3-6.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../part3/3-4.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="../part3/3-6.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:9000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
